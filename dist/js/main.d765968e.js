(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{(()=>{let t=0;const e=document.querySelectorAll(".slider-image"),o=Array.from(document.querySelectorAll(".points circle")),n=()=>{o.forEach((t=>t.classList.remove("point_active"))),e.forEach((t=>t.style.display="none")),e[t].style.display="block",o[t].classList.add("point_active"),t=(t+1)%e.length},r=e=>{o.forEach((t=>t.classList.remove("point_active"))),e.target.classList.add("point_active"),t=o.indexOf(e.target),n()};o.forEach((t=>t.addEventListener("click",r))),e.forEach(((t,e)=>{t.style.display=0===e?"block":"none"})),n(),setInterval(n,5e3)})(),(()=>{const t=document.querySelector(".sidebar-wrapper"),e=document.querySelector(".header"),o=document.querySelector(".promo-one"),n=document.querySelector(".promo-two");window.addEventListener("scroll",(()=>{const r=window.scrollY>0,i=t.getBoundingClientRect(),c=o.getBoundingClientRect(),a=n.getBoundingClientRect();r&&i.top<110?(t.style.position="fixed",t.style.top=`${e.offsetHeight}px`):(t.style.position="absolute",t.style.top="840px"),o.style.display=r&&c.top<110?"none":"block",n.style.display=r&&a.top<110?"none":"block"}))})(),function(){const t=document.querySelector(".book-container"),e=document.querySelector(".load-more-button"),o=document.querySelectorAll(".sidebar-category__item"),n=document.querySelector(".nav__icon_count-circle"),r=n.querySelector(".nav__icon_count-text");let i=0,c="Architecture";const a={};async function s(o=c){try{const n=await fetch(`https://www.googleapis.com/books/v1/volumes?q=subject:${o}&key=AIzaSyCdn-QMlS7F2R3184SxsPsYYjEAL9jTCiw&printType=books&startIndex=${i}&maxResults=6&langRestrict=en`);if(!n.ok)throw new Error(`Ошибка HTTP! статус: ${n.status}`);const r=await n.json();console.log(r),function(e){const o=JSON.parse(localStorage.getItem("cartItems"))||[];e.items.forEach((e=>{const{volumeInfo:n,saleInfo:r}=e,i=n.imageLinks?n.imageLinks.thumbnail:"https://via.placeholder.com/128x192.png?text=No+Cover",c=n.authors?n.authors.join(", "):"Unknown author",s=n.title||"No title",u=`${s}-${c}`,p=n.description||"No description";let{rating:m,ratingCount:g,price:h,priceSource:y}=function(t,e,o){if(a[e])return a[e];const n=t.volumeInfo,r=n.averageRating?Math.floor(n.averageRating):Math.floor(5*Math.random())+1,i=n.ratingsCount?n.ratingsCount:Math.floor(1e3*Math.random());let c;if(o?.retailPrice?.amount){let t=o.retailPrice.amount;"EUR"===o.retailPrice.currencyCode?(console.log(`Цена в EUR: ${t}, конвертация в USD`),t*=.92):"RUB"===o.retailPrice.currencyCode?(console.log(`Цена в RUB: ${t}, конвертация в USD`),t*=.1):"GBP"===o.retailPrice.currencyCode&&(console.log(`Цена в GBP: ${t}, конвертация в USD`),t*=1.28),c=t.toFixed(2)}else c=(10*Math.random()).toFixed(2);return c=`$${c}`,a[e]={rating:r,ratingCount:i,price:c,priceSource:void 0},a[e]}(e,u,r);console.log(`Загружена книга: ${s} автор(ы): ${c} цена: ${h} (${y})`);const f=function({imageUrl:t,authors:e,title:o,rating:n,ratingCount:r,description:i,price:c,priceSource:a,cartItems:s}){const u=document.createElement("div");u.classList.add("book");const p=document.createElement("div");p.classList.add("book-image");const m=document.createElement("img");m.src=t,m.classList.add("book-image__image"),m.onerror=()=>{m.src="https://via.placeholder.com/128x192.png?text=No+Cover"},p.appendChild(m);const g=document.createElement("div");g.classList.add("book-info"),g.appendChild(l("h3","book-author",e)),g.appendChild(l("p","book-title",o)),g.appendChild(function(t,e){const o=document.createElement("div");return o.classList.add("book-rating"),o.innerHTML=function(t){let e="";for(let o=1;o<=5;o++)e+=`<svg class="star" width="12" height="12" viewBox="0 0 32 32"><use xlink:href="#star" fill="${o<=t?"#F2C94C":"#EEEDF5"}"></use></svg>`;return e}(t)+`<p>${e} review${e>1?"s":""}</p>`,o}(n,r)),g.appendChild(l("p","book-description",i)),g.appendChild(l("p","book-price",`${c}`));const h=function({title:t,authors:e,price:o,cartItems:n}){const r=document.createElement("button");r.classList.add("button-buy"),r.setAttribute("aria-label","Buy now");const i=n.some((o=>o.title===t&&o.author===e));return r.textContent=i?"In the cart":"Buy now",r.classList.toggle("button-in-cart",i),r.addEventListener("click",(()=>{const n=JSON.parse(localStorage.getItem("cartItems"))||[],i=n.findIndex((o=>o.title===t&&o.author===e));-1===i?(n.push({title:t,author:e,price:o}),r.textContent="In the cart",r.classList.add("button-in-cart")):(n.splice(i,1),r.textContent="Buy now",r.classList.remove("button-in-cart")),localStorage.setItem("cartItems",JSON.stringify(n)),d(n.length)})),r}({title:o,authors:e,price:c,cartItems:s});return g.appendChild(h),u.appendChild(p),u.appendChild(g),u}({imageUrl:i,authors:c,title:s,rating:m,ratingCount:g,description:p,price:h,priceSource:y,cartItems:o});t.appendChild(f)}))}(r),i+=6,e.style.display=i>=r.totalItems?"none":"block"}catch(t){console.error(t)}}function l(t,e,o){const n=document.createElement(t);return n.classList.add(e),n.textContent=o,n}function d(t){t>0?(n.style.display="block",r.textContent=t.toString()):n.style.display="none"}document.body.insertAdjacentHTML("afterbegin",'\n        <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">\n            <symbol id="star" viewBox="0 0 32 32">\n                <path d="M16 2.5l4.5 9.1 10 1.4-7.2 7 1.7 10-9-4.8-9 4.8 1.7-10-7.2-7 10-1.4z"/>\n            </symbol>\n        </svg>\n    '),e.addEventListener("click",(()=>{console.log("Кнопка 'Загрузить ещё' нажата"),s(c)})),o.forEach((e=>{e.addEventListener("click",(async n=>{n.preventDefault();const r=n.target.textContent.trim();o.forEach((t=>t.classList.remove("sidebar-category__item_active"))),e.classList.add("sidebar-category__item_active"),await async function(e){c=e,i=0,t.innerHTML="",console.log(`Смена категории: ${e}`),await s(e)}(r)}))})),d((JSON.parse(localStorage.getItem("cartItems"))||[]).length),window.addEventListener("beforeunload",(()=>{localStorage.setItem("cartItems",JSON.stringify([]))})),s()}()}))})();
//# sourceMappingURL=main.d765968e.js.map